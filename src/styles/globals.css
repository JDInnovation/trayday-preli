@tailwind base;
@tailwind components;
@tailwind utilities;

/* ===========================
   DESIGN TOKENS
   =========================== */
:root {
  --bg: #0b0f19;
  --bg-soft: #0f1524;
  --surface: rgba(255, 255, 255, 0.04);
  --card: rgba(255, 255, 255, 0.06);
  --card-2: rgba(255, 255, 255, 0.08);
  --border: rgba(255, 255, 255, 0.12);
  --text: #e6eaf2;
  --text-sub: #9aa4b2;
  --ok: #20c997;
  --danger: #ff6b6b;
  --warn: #ffd166;
  --brand: #7c5cff;

  --radius: 16px;
  --shadow-1: 0 8px 24px rgba(0, 0, 0, 0.35);
  --shadow-2: 0 14px 42px rgba(0, 0, 0, 0.45);
}

/* Light mode opcional (ativar em <html data-theme="light">) */
html[data-theme="light"] {
  --bg: #f6f7fb;
  --bg-soft: #eef1f6;
  --surface: rgba(0, 0, 0, 0.02);
  --card: rgba(255, 255, 255, 0.9);
  --card-2: rgba(255, 255, 255, 1);
  --border: rgba(0, 0, 0, 0.12);
  --text: #1a1f2c;
  --text-sub: #475569;
  --ok: #0ea5a5;
  --danger: #e11d48;
  --warn: #d97706;
  --brand: #6d28d9;
}

/* ===========================
   BASE
   =========================== */
@layer base {
  * { @apply antialiased; }

  html, body, #__next { height: 100%; }
  body {
    background: var(--bg); /* cor base sólida */
    position: relative;    /* para o ::before fixo funcionar bem em iOS */
    color: var(--text);
  }

  /* Fundo contínuo sem quebras */
  body::before {
    content: "";
    position: fixed;   /* cola ao viewport (não “acaba” ao fazer scroll) */
    inset: -40vmax;    /* overscan gigante para fora do ecrã */
    z-index: -1;
    pointer-events: none;
    background:
      /* manchas grandes, bem suaves, que se estendem para além da página */
      radial-gradient(60vmax 60vmax at 10% -10%, #1b2142 0%, transparent 60%),
      radial-gradient(70vmax 60vmax at 110% 5%, #231b4a 0%, transparent 65%),
      /* toque subtil angular para dar profundidade */
      conic-gradient(from 180deg at 50% 120%, rgba(124,92,255,.12), transparent 70%),
      /* gradiente base */
      linear-gradient(180deg, var(--bg) 0%, var(--bg-soft) 100%);
    filter: blur(28px) saturate(105%); /* suaviza as transições */
  }

  /* Ruído fininho para esconder banding em ecrãs grandes (opcional) */
  body::after {
    content: "";
    position: fixed;
    inset: 0;
    z-index: -1;
    pointer-events: none;
    opacity: .03;
    mix-blend-mode: overlay;
    background-image:
      radial-gradient(1px 1px at 25% 32%, rgba(255,255,255,.8) 0, transparent 60%),
      radial-gradient(1px 1px at 75% 64%, rgba(255,255,255,.6) 0, transparent 60%),
      radial-gradient(1px 1px at 10% 80%, rgba(255,255,255,.7) 0, transparent 60%),
      radial-gradient(1px 1px at 60% 10%, rgba(255,255,255,.7) 0, transparent 60%);
    background-size: 300px 300px, 260px 260px, 340px 340px, 280px 280px;
    background-position: 0 0, 40px 80px, 120px 20px, 60px 160px;
  }

  a { color: var(--brand); }
}

/* ===========================
   UTILITÁRIOS DE TEXTO
   =========================== */
@layer utilities {
  .text-sub { color: var(--text-sub); }
  .text-ok { color: var(--ok); }
  .text-danger { color: var(--danger); }
  .text-warn { color: var(--warn); }
  .small { @apply text-sm; color: var(--text-sub); }
}

/* ===========================
   COMPONENTS
   =========================== */
@layer components {
  /* CARTÕES */
  .card {
    background: linear-gradient(180deg, var(--card) 0%, var(--surface) 100%);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    box-shadow: var(--shadow-1);
    @apply p-4 md:p-5;
    backdrop-filter: blur(8px);
  }

  .card-ghost {
    background: linear-gradient(180deg, transparent 0%, transparent 100%);
    border: 1px dashed var(--border);
    border-radius: var(--radius);
    @apply p-4 md:p-5;
  }

  /* INPUTS */
  .label { @apply mb-1 text-sm font-medium; color: var(--text-sub); }

  .input, .select, .textarea {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    color: var(--text);
    transition: all .2s ease;
    outline: none;
  }
  .input, .select { @apply px-3 py-2; }
  .textarea { @apply px-3 py-2; resize: vertical; }

  .input:focus, .select:focus, .textarea:focus {
    border-color: color-mix(in oklab, var(--brand) 60%, white 0%);
    box-shadow: 0 0 0 3px color-mix(in oklab, var(--brand) 35%, transparent 100%);
  }

  /* BOTÕES */
  .btn {
    border-radius: 12px;
    border: 1px solid var(--border);
    background: linear-gradient(180deg, var(--card-2) 0%, var(--surface) 100%);
    color: var(--text);
    @apply px-3 py-2 text-sm font-medium inline-flex items-center gap-2;
    transition: transform .06s ease, background .2s ease, border-color .2s ease;
  }
  .btn:hover {
    border-color: color-mix(in oklab, var(--brand) 40%, var(--border) 60%);
  }
  .btn:active { transform: translateY(1px); }

  .btn-primary {
    background: linear-gradient(180deg, color-mix(in oklab, var(--brand) 82%, #000 0%) 0%, var(--brand) 100%);
    border-color: color-mix(in oklab, var(--brand) 70%, #000 30%);
    box-shadow: 0 8px 24px color-mix(in oklab, var(--brand) 25%, transparent 75%);
  }
  .btn-primary:hover {
    filter: brightness(1.05);
  }

  .btn-ghost {
    background: transparent;
    border-color: var(--border);
    @apply text-sm;
  }

  .btn-danger {
    background: linear-gradient(180deg, color-mix(in oklab, var(--danger) 80%, #000 0%) 0%, var(--danger) 100%);
    border-color: color-mix(in oklab, var(--danger) 70%, #000 30%);
  }

  .btn-outline {
    background: transparent;
    border-color: var(--brand);
    color: var(--brand);
  }

  /* BADGE */
  .badge {
    @apply inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full;
    background: var(--surface);
    border: 1px solid var(--border);
    color: var(--text-sub);
  }

  /* TABELA */
  .table-wrap {
    @apply overflow-x-auto;
    scrollbar-gutter: stable both-edges;
  }
  .table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    border: 1px solid var(--border);
    border-radius: 12px;
    overflow: hidden;
    background: linear-gradient(180deg, var(--card) 0%, var(--surface) 100%);
    box-shadow: var(--shadow-1);
  }
  .table thead th {
    @apply text-left text-xs uppercase tracking-wide;
    color: var(--text-sub);
    background: color-mix(in oklab, var(--surface) 70%, #000 30%);
    border-bottom: 1px solid var(--border);
    padding: 10px 12px;
  }
  .table tbody td {
    padding: 12px;
    border-bottom: 1px solid color-mix(in oklab, var(--border) 60%, transparent 40%);
  }
  .table tbody tr:hover {
    background: color-mix(in oklab, var(--surface) 85%, #000 15%);
  }
  .table tfoot td {
    padding: 12px;
    border-top: 1px solid var(--border);
    color: var(--text-sub);
  }

  /* KPI */
  .kpi {
    @apply flex flex-col items-center justify-center text-center gap-1;
  }
  .kpi-value {
    @apply text-2xl md:text-3xl font-semibold;
    letter-spacing: -0.02em;
  }
  .kpi-label { @apply small; }

  /* RECHARTS TOOLTIP */
  .recharts-default-tooltip {
    background: linear-gradient(180deg, var(--card) 0%, var(--surface) 100%) !important;
    border: 1px solid var(--border) !important;
    box-shadow: var(--shadow-2) !important;
    color: var(--text) !important;
    border-radius: 12px !important;
    padding: 8px 10px !important;
  }

  /* MODAL base (caso uses popups de KPIs) */
  .modal-backdrop {
    @apply fixed inset-0;
    background: rgba(0,0,0,.55);
    backdrop-filter: blur(3px);
    z-index: 40;
  }
  .modal {
    @apply fixed inset-0 flex items-center justify-center p-4;
    z-index: 50;
  }
  .modal-panel {
    background: linear-gradient(180deg, var(--card) 0%, var(--surface) 100%);
    border: 1px solid var(--border);
    border-radius: 16px;
    box-shadow: var(--shadow-2);
    @apply w-full max-w-3xl p-4 md:p-6;
  }

  /* CHIPS / PRIVACIDADE DE SALDO */
  .chip {
    @apply inline-flex items-center gap-2 px-3 py-1.5 text-sm rounded-full border;
    background: var(--surface);
    border-color: var(--border);
    color: var(--text-sub);
  }

  /* CALENDÁRIO (ajustes suaves, o TSX já usa classes) */
  .cal-day {
    border: 1px solid var(--border);
    background: linear-gradient(180deg, var(--card) 0%, var(--surface) 100%);
    border-radius: 12px;
    transition: transform .08s ease, background .2s ease, border-color .2s ease;
  }
  .cal-day:hover {
    transform: translateY(-1px);
    border-color: color-mix(in oklab, var(--brand) 40%, var(--border) 60%);
  }
  .cal-day.is-empty {
    opacity: .55;
    filter: grayscale(.35);
  }
}

/* ===========================
   SCROLLBAR (suave)
   =========================== */
* {
  scrollbar-width: thin;
  scrollbar-color: var(--border) transparent;
}
*::-webkit-scrollbar {
  height: 10px;
  width: 10px;
}
*::-webkit-scrollbar-track {
  background: transparent;
}
*::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, var(--card-2), var(--surface));
  border: 1px solid var(--border);
  border-radius: 999px;
}

/* ===========================
   LAYOUT AJUSTES RÁPIDOS
   =========================== */
.container-padded {
  @apply max-w-7xl mx-auto px-3 md:px-6;
}

/* Botões minimalistas dentro de cards (ex.: ícones de ação) */
.icon-btn {
  @apply inline-flex items-center justify-center rounded-md;
  width: 34px; height: 34px;
  border: 1px solid var(--border);
  background: var(--surface);
  transition: background .2s ease, border-color .2s ease, transform .06s ease;
}
.icon-btn:hover {
  border-color: color-mix(in oklab, var(--brand) 40%, var(--border) 60%);
}
.icon-btn:active { transform: translateY(1px); }
